package com.xuyong.study.htmlparser;

import org.htmlparser.NodeFilter;
import org.htmlparser.Parser;
import org.htmlparser.filters.TagNameFilter;
import org.htmlparser.tags.TableRow;
import org.htmlparser.util.NodeList;
import org.htmlparser.util.ParserException;
import org.htmlparser.visitors.HtmlPage;

public class TestHtml {

	public static void main(String[] args) {
		String htmlStr = "<!DOCTYPE html><html>      <head>        <meta http-equiv='Content-type' content='text/html; charset=utf-8'/><link rel='stylesheet' href='/static/bootstrap.min.css' type='text/css'/><link rel='stylesheet' href='/static/vis.min.css' type='text/css'/><link rel='stylesheet' href='/static/webui.css' type='text/css'/><link rel='stylesheet' href='/static/timeline-view.css' type='text/css'/><script src='/static/sorttable.js'></script><script src='/static/jquery-1.11.1.min.js'></script><script src='/static/vis.min.js'></script><script src='/static/bootstrap-tooltip.js'></script><script src='/static/initialize-tooltips.js'></script><script src='/static/table.js'></script><script src='/static/additional-metrics.js'></script><script src='/static/timeline-view.js'></script><script src='/static/log-view.js'></script>                <title>Spark Master at spark://sd-bigdata-spark10-74-47.idc.vip.com:7077</title>      </head>      <body>        <div class='container-fluid'>          <div class='row-fluid'>            <div class='span12'>              <h3 style='vertical-align: middle; display: inline-block;'>                <a style='text-decoration: none' href='/'>                  <img src='/static/spark-logo-77x50px-hd.png'/>                  <span class='version' style='margin-right: 15px;'>2.0.0</span>                </a>                Spark Master at spark://sd-bigdata-spark10-74-47.idc.vip.com:7077              </h3>            </div>          </div>          <div class='row-fluid'>          <div class='span12'>            <ul class='unstyled'>              <li><strong>URL:</strong> spark://sd-bigdata-spark10-74-47.idc.vip.com:7077</li>              <li>                    <strong>REST URL:</strong> spark://sd-bigdata-spark10-74-47.idc.vip.com:6066                    <span class='rest-uri'> (cluster mode)</span>                  </li>              <li><strong>Alive Workers:</strong> 9</li>              <li><strong>Cores in use:</strong> 648 Total,                0 Used</li>              <li><strong>Memory in use:</strong>                1125.5 GB Total,                0.0 B Used</li>              <li><strong>Applications:</strong>                0 <a href='#running-app'>Running</a>,                34 <a href='#completed-app'>Completed</a> </li>              <li><strong>Drivers:</strong>                0 Running,                0 Completed </li>              <li><strong>Status:</strong> ALIVE</li>            </ul>          </div>        </div><div class='row-fluid'>          <div class='span12'>            <h4> Workers </h4>            <table class='table table-bordered table-condensed table-striped sortable'>      <thead><th width='' class=''>Worker Id</th><th width='' class=''>Address</th><th width='' class=''>State</th><th width='' class=''>Cores</th><th width='' class=''>Memory</th></thead>      <tbody>        <tr>      <td>        <a href='http://10.208.74.48:8083'>worker-20161031150621-10.208.74.48-12271</a>      </td>      <td>10.208.74.48:12271</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.49:8083'>worker-20161031150621-10.208.74.49-48113</a>      </td>      <td>10.208.74.49:48113</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.51:8083'>worker-20161031150621-10.208.74.51-30330</a>      </td>      <td>10.208.74.51:30330</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.52:8083'>worker-20161031150621-10.208.74.52-29139</a>      </td>      <td>10.208.74.52:29139</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.53:8083'>worker-20161031150621-10.208.74.53-29247</a>      </td>      <td>10.208.74.53:29247</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.55:8083'>worker-20161031150621-10.208.74.55-57671</a>      </td>      <td>10.208.74.55:57671</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.56:8083'>worker-20161031150621-10.208.74.56-29824</a>      </td>      <td>10.208.74.56:29824</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.54:8083'>worker-20161101115037-10.208.74.54-64761</a>      </td>      <td>10.208.74.54:64761</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.208.74.50:8083'>worker-20161101115109-10.208.74.50-53598</a>      </td>      <td>10.208.74.50:53598</td>      <td>ALIVE</td>      <td>72 (0 Used)</td>      <td sorttable_customkey='128061.0'>        125.1 GB        (0.0 B Used)      </td>    </tr>      </tbody>    </table>          </div>        </div><div class='row-fluid'>          <div class='span12'>            <h4 id='running-app'> Running Applications </h4>            <table class='table table-bordered table-condensed table-striped sortable'>      <thead><th width='' class=''>Application ID</th><th width='' class=''>Name</th><th width='' class=''>Cores</th><th width='' class=''>Memory per Node</th><th width='' class=''>Submitted Time</th><th width='' class=''>User</th><th width='' class=''>State</th><th width='' class=''>Duration</th></thead>      <tbody>              </tbody>    </table>          </div>        </div><div>                  </div><div class='row-fluid'>          <div class='span12'>            <h4 id='completed-app'> Completed Applications </h4>            <table class='table table-bordered table-condensed table-striped sortable'>      <thead><th width='' class=''>Application ID</th><th width='' class=''>Name</th><th width='' class=''>Cores</th><th width='' class=''>Memory per Node</th><th width='' class=''>Submitted Time</th><th width='' class=''>User</th><th width='' class=''>State</th><th width='' class=''>Duration</th></thead>      <tbody>        <tr>      <td>        <a href='app?appId=app-20161104182834-0033'>app-20161104182834-0033</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='81920'>        80.0 GB      </td>      <td>2016/11/04 18:28:34</td>      <td>spark</td>      <td>FINISHED</td>      <td>15 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161104174942-0032'>app-20161104174942-0032</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/04 17:49:42</td>      <td>spark</td>      <td>FINISHED</td>      <td>1.1 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161104174343-0031'>app-20161104174343-0031</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/04 17:43:43</td>      <td>spark</td>      <td>FINISHED</td>      <td>3.0 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161104173101-0030'>app-20161104173101-0030</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='10240'>        10.0 GB      </td>      <td>2016/11/04 17:31:01</td>      <td>spark</td>      <td>FINISHED</td>      <td>11 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161104165513-0029'>app-20161104165513-0029</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='10240'>        10.0 GB      </td>      <td>2016/11/04 16:55:13</td>      <td>spark</td>      <td>FINISHED</td>      <td>1.0 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161104161617-0028'>app-20161104161617-0028</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='10240'>        10.0 GB      </td>      <td>2016/11/04 16:16:17</td>      <td>spark</td>      <td>FINISHED</td>      <td>31 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103215434-0027'>app-20161103215434-0027</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 21:54:34</td>      <td>spark</td>      <td>FINISHED</td>      <td>2 s</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103210228-0026'>app-20161103210228-0026</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 21:02:28</td>      <td>spark</td>      <td>FINISHED</td>      <td>51 s</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103192137-0025'>app-20161103192137-0025</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 19:21:37</td>      <td>spark</td>      <td>FINISHED</td>      <td>1.2 h</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103191246-0024'>app-20161103191246-0024</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 19:12:46</td>      <td>spark</td>      <td>FINISHED</td>      <td>2.5 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103190005-0023'>app-20161103190005-0023</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 19:00:05</td>      <td>spark</td>      <td>FINISHED</td>      <td>3.4 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103183245-0022'>app-20161103183245-0022</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 18:32:45</td>      <td>spark</td>      <td>FINISHED</td>      <td>18 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103174536-0021'>app-20161103174536-0021</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 17:45:36</td>      <td>spark</td>      <td>FINISHED</td>      <td>10 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103173047-0020'>app-20161103173047-0020</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='81920'>        80.0 GB      </td>      <td>2016/11/03 17:30:47</td>      <td>spark</td>      <td>FINISHED</td>      <td>9.5 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103164834-0019'>app-20161103164834-0019</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='51200'>        50.0 GB      </td>      <td>2016/11/03 16:48:34</td>      <td>spark</td>      <td>FINISHED</td>      <td>29 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103164216-0018'>app-20161103164216-0018</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='10240'>        10.0 GB      </td>      <td>2016/11/03 16:42:16</td>      <td>spark</td>      <td>FINISHED</td>      <td>5.9 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103162028-0017'>app-20161103162028-0017</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/03 16:20:28</td>      <td>spark</td>      <td>FINISHED</td>      <td>21 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161103160247-0016'>app-20161103160247-0016</a>              </td>      <td>        LRModel      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/03 16:02:47</td>      <td>spark</td>      <td>FINISHED</td>      <td>1.1 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161102160246-0015'>app-20161102160246-0015</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/02 16:02:46</td>      <td>spark</td>      <td>FINISHED</td>      <td>2.7 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161102154634-0014'>app-20161102154634-0014</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/02 15:46:34</td>      <td>spark</td>      <td>FINISHED</td>      <td>54 s</td>    </tr><tr>      <td>        <a href='app?appId=app-20161102145943-0013'>app-20161102145943-0013</a>              </td>      <td>        LRDriver      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/02 14:59:43</td>      <td>spark</td>      <td>FINISHED</td>      <td>35 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101202316-0010'>app-20161101202316-0010</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 20:23:16</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>19.0 h</td>    </tr><tr>      <td>        <a href='app?appId=app-20161102143046-0012'>app-20161102143046-0012</a>              </td>      <td>        LRDriver      </td>      <td>        0      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/02 14:30:46</td>      <td>spark</td>      <td>FINISHED</td>      <td>2 s</td>    </tr><tr>      <td>        <a href='app?appId=app-20161102142012-0011'>app-20161102142012-0011</a>              </td>      <td>        LRDriver      </td>      <td>        0      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/02 14:20:12</td>      <td>spark</td>      <td>FINISHED</td>      <td>2 s</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101200514-0009'>app-20161101200514-0009</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 20:05:14</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>23 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101171408-0008'>app-20161101171408-0008</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 17:14:08</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>1.9 h</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101152509-0007'>app-20161101152509-0007</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 15:25:09</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>1.8 h</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101151915-0006'>app-20161101151915-0006</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 15:19:15</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>3.8 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101144838-0005'>app-20161101144838-0005</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 14:48:38</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>30 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101134659-0004'>app-20161101134659-0004</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 13:46:59</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>56 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101113813-0003'>app-20161101113813-0003</a>              </td>      <td>        Spark shell      </td>      <td>        648      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 11:38:13</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>60 min</td>    </tr><tr>      <td>        <a href='app?appId=app-20161101102338-0002'>app-20161101102338-0002</a>              </td>      <td>        Spark shell      </td>      <td>        504      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/11/01 10:23:38</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>1.1 h</td>    </tr><tr>      <td>        <a href='app?appId=app-20161031153545-0000'>app-20161031153545-0000</a>              </td>      <td>        LRDriver      </td>      <td>        504      </td>      <td sorttable_customkey='20480'>        20.0 GB      </td>      <td>2016/10/31 15:35:45</td>      <td>spark</td>      <td>FINISHED</td>      <td>4.1 h</td>    </tr><tr>      <td>        <a href='app?appId=app-20161031160224-0001'>app-20161031160224-0001</a>              </td>      <td>        Spark shell      </td>      <td>        0      </td>      <td sorttable_customkey='2000'>        2000.0 MB      </td>      <td>2016/10/31 16:02:24</td>      <td>u_jrd_lv1</td>      <td>FINISHED</td>      <td>57 min</td>    </tr>      </tbody>    </table>          </div>        </div><div>                  </div>        </div>      </body>    </html>";
		System.out.println(getContent(htmlStr, "<h4> Workers </h4>", "Running Applications"));
//		String htmlcode = "<BODY><table class='table table-bordered table-condensed table-striped sortable'><thead><th width='' class=''>Worker Id</th><th width='' class=''>Address</th><th width='' class=''>State</th><th width='' class=''>Cores</th><th width='' class=''>Memory</th></thead>      <tbody>        <tr>      <td>        <a href='http://10.199.250.75:8081'>worker-20160805101307-10.199.250.75-48583</a>      </td>      <td>10.199.250.75:48583</td>      <td>ALIVE</td>      <td>8 (0 Used)</td>      <td sorttable_customkey='14927.0'>        14.6 GB        (0.0 B Used)      </td>    </tr><tr>      <td>        <a href='http://10.199.250.76:8081'>worker-20160805101310-10.199.250.76-36464</a>      </td>      <td>10.199.250.76:36464</td>      <td>ALIVE</td>      <td>8 (0 Used)</td>      <td sorttable_customkey='14927.0'>        14.6 GB        (0.0 B Used)      </td>    </tr>      </tbody>    </table></BODY>";
//		Parser parser = Parser.createParser(htmlcode, "utf-8");
//		HtmlPage page = new HtmlPage(parser);
//		try {
//			parser.visitAllNodesWith(page);
//		} catch (ParserException e1) {
//			e1 = null;
//		}
//		NodeList nodelist = page.getBody();
//		NodeFilter filter = new TagNameFilter("TR");
//		nodelist = nodelist.extractAllNodesThatMatch(filter, true);
//		System.out.println(nodelist.size());
//		for (int i = 0; i < nodelist.size(); i++) {
//			TableRow tableRow = (TableRow) nodelist.elementAt(i);
//			System.out.println(tableRow.getChild(3).getFirstChild().getText() + "----" + tableRow.getChild(5).getFirstChild().getText() +  "\n");
//		}
	}
	
	private static String getContent(String content, String begin, String end) {
		String result = "";
        int begin_index = content.indexOf(begin);
        int end_index = content.indexOf(end);
        if (begin_index != -1 && end_index != -1) {
        	result = content.substring(begin_index + begin.length(), end_index);
        }
        return result;
	}
	
}
